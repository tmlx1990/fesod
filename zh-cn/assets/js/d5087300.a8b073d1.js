"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2516],{508:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var l=t(9729);const i={},r=l.createContext(i);function o(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),l.createElement(r.Provider,{value:n},e.children)}},1583:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"write/style","title":"\u6837\u5f0f","description":"\u672c\u7ae0\u8282\u5c06\u4ecb\u7ecd\u5199\u5165\u6570\u636e\u65f6\u7684\u6837\u5f0f\u8bbe\u7f6e\u3002","source":"@site/i18n/zh-cn/docusaurus-plugin-content-docs/current/write/style.md","sourceDirName":"write","slug":"/write/style","permalink":"/zh-cn/docs/write/style","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/fesod/edit/main/website/i18n/zh-cn/docusaurus-plugin-content-docs/current/write/style.md","tags":[],"version":"current","frontMatter":{"id":"style","title":"\u6837\u5f0f"},"sidebar":"docs","previous":{"title":"\u5b9e\u4f53\u7c7b","permalink":"/zh-cn/docs/write/pojo"},"next":{"title":"\u4e0e Spring \u96c6\u6210","permalink":"/zh-cn/docs/write/spring"}}');var i=t(5813),r=t(508);const o={id:"style",title:"\u6837\u5f0f"},s="\u6837\u5f0f",a={},d=[{value:"\u6ce8\u89e3",id:"\u6ce8\u89e3",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:3},{value:"POJO \u7c7b",id:"pojo-\u7c7b",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c",level:3},{value:"\u5185\u7f6e\u62e6\u622a\u5668",id:"\u5185\u7f6e\u62e6\u622a\u5668",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0-1",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-1",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c-1",level:3},{value:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668",id:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0-2",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-2",level:3},{value:"\u81ea\u5b9a\u4e49 POI \u6837\u5f0f",id:"\u81ea\u5b9a\u4e49-poi-\u6837\u5f0f",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0-3",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-3",level:3},{value:"\u5217\u5bbd\u548c\u884c\u9ad8",id:"\u5217\u5bbd\u548c\u884c\u9ad8",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0-4",level:3},{value:"POJO\u7c7b",id:"pojo\u7c7b",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-4",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c-2",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u6837\u5f0f",children:"\u6837\u5f0f"})}),"\n",(0,i.jsx)(n.p,{children:"\u672c\u7ae0\u8282\u5c06\u4ecb\u7ecd\u5199\u5165\u6570\u636e\u65f6\u7684\u6837\u5f0f\u8bbe\u7f6e\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u6ce8\u89e3",children:"\u6ce8\u89e3"}),"\n",(0,i.jsx)(n.h3,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7\u5b9e\u4f53\u7c7b\u4e2d\u7684\u6ce8\u89e3\u8bbe\u7f6e\u5355\u5143\u683c\u6837\u5f0f\uff0c\u5305\u62ec\u5b57\u4f53\u3001\u80cc\u666f\u989c\u8272\u3001\u884c\u9ad8\u7b49\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"pojo-\u7c7b",children:"POJO \u7c7b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Getter\n@Setter\n@EqualsAndHashCode\n// \u8bbe\u7f6e\u5934\u90e8\u80cc\u666f\u4e3a\u7ea2\u8272\n@HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 10)\n// \u8bbe\u7f6e\u5934\u90e8\u5b57\u4f53\u5927\u5c0f\u4e3a20\n@HeadFontStyle(fontHeightInPoints = 20)\n// \u8bbe\u7f6e\u5185\u5bb9\u80cc\u666f\u4e3a\u7eff\u8272\n@ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 17)\n// \u8bbe\u7f6e\u5185\u5bb9\u5b57\u4f53\u5927\u5c0f\u4e3a20\n@ContentFontStyle(fontHeightInPoints = 20)\npublic class DemoStyleData {\n    // \u5355\u72ec\u8bbe\u7f6e\u67d0\u5217\u7684\u5934\u90e8\u548c\u5185\u5bb9\u6837\u5f0f\n    @HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 14)\n    @HeadFontStyle(fontHeightInPoints = 30)\n    @ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 40)\n    @ContentFontStyle(fontHeightInPoints = 30)\n    @ExcelProperty("\u5b57\u7b26\u4e32\u6807\u9898")\n    private String string;\n\n    @ExcelProperty("\u65e5\u671f\u6807\u9898")\n    private Date date;\n\n    @ExcelProperty("\u6570\u5b57\u6807\u9898")\n    private Double doubleData;\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Test\npublic void annotationStyleWrite() {\n    String fileName = "annotationStyleWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, DemoStyleData.class)\n        .sheet()\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u7ed3\u679c",children:"\u7ed3\u679c"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(3659).A+"",width:"529",height:"427"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\u5185\u7f6e\u62e6\u622a\u5668",children:"\u5185\u7f6e\u62e6\u622a\u5668"}),"\n",(0,i.jsx)(n.h3,{id:"\u6982\u8ff0-1",children:"\u6982\u8ff0"}),"\n",(0,i.jsxs)(n.p,{children:["\u901a\u8fc7 ",(0,i.jsx)(n.code,{children:"HorizontalCellStyleStrategy"})," \u4e3a\u8868\u5934\u548c\u5185\u5bb9\u5206\u522b\u8bbe\u7f6e\u6837\u5f0f\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-1",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Test\npublic void handlerStyleWrite() {\n    String fileName = "handlerStyleWrite" + System.currentTimeMillis() + ".xlsx";\n\n    // \u5b9a\u4e49\u8868\u5934\u6837\u5f0f\n    WriteCellStyle headStyle = new WriteCellStyle();\n    headStyle.setFillForegroundColor(IndexedColors.RED.getIndex()); // \u7ea2\u8272\u80cc\u666f\n    WriteFont headFont = new WriteFont();\n    headFont.setFontHeightInPoints((short) 20); // \u5b57\u4f53\u5927\u5c0f\u4e3a20\n    headStyle.setWriteFont(headFont);\n\n    // \u5b9a\u4e49\u5185\u5bb9\u6837\u5f0f\n    WriteCellStyle contentStyle = new WriteCellStyle();\n    contentStyle.setFillForegroundColor(IndexedColors.GREEN.getIndex()); // \u7eff\u8272\u80cc\u666f\n    contentStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);\n    WriteFont contentFont = new WriteFont();\n    contentFont.setFontHeightInPoints((short) 20);\n    contentStyle.setWriteFont(contentFont);\n\n    // \u4f7f\u7528\u7b56\u7565\u8bbe\u7f6e\u6837\u5f0f\n    HorizontalCellStyleStrategy styleStrategy =\n        new HorizontalCellStyleStrategy(headStyle, contentStyle);\n\n    FastExcel.write(fileName, DemoData.class)\n        .registerWriteHandler(styleStrategy)\n        .sheet("\u6837\u5f0f\u6a21\u677f")\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u7ed3\u679c-1",children:"\u7ed3\u679c"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(5966).A+"",width:"345",height:"288"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668",children:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668"}),"\n",(0,i.jsx)(n.h3,{id:"\u6982\u8ff0-2",children:"\u6982\u8ff0"}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u5df2\u6709\u7b56\u7565\u65e0\u6cd5\u6ee1\u8db3\u9700\u6c42\uff0c\u53ef\u4ee5\u5b9e\u73b0 ",(0,i.jsx)(n.code,{children:"CellWriteHandler"})," \u63a5\u53e3\u5bf9\u6837\u5f0f\u8fdb\u884c\u5b8c\u5168\u81ea\u5b9a\u4e49\u63a7\u5236\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-2",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.p,{children:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Slf4j\npublic class CustomCellStyleWriteHandler implements CellWriteHandler {\n\n    @Override\n    public void afterCellDispose(CellWriteHandlerContext context) {\n        // \u4ec5\u8bbe\u7f6e\u5185\u5bb9\u5355\u5143\u683c\u7684\u6837\u5f0f\n        if (BooleanUtils.isNotTrue(context.getHead())) {\n            WriteCellData<?> cellData = context.getFirstCellData();\n            WriteCellStyle writeCellStyle = cellData.getOrCreateStyle();\n\n            // \u8bbe\u7f6e\u80cc\u666f\u989c\u8272\u4e3a\u9ec4\u8272\n            writeCellStyle.setFillForegroundColor(IndexedColors.YELLOW.getIndex());\n            writeCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);\n\n            // \u8bbe\u7f6e\u5b57\u4f53\u4e3a\u84dd\u8272\n            WriteFont writeFont = new WriteFont();\n            writeFont.setColor(IndexedColors.BLUE.getIndex());\n            writeFont.setFontHeightInPoints((short) 14); // \u5b57\u4f53\u5927\u5c0f\u4e3a14\n            writeCellStyle.setWriteFont(writeFont);\n\n            log.info("\u5df2\u81ea\u5b9a\u4e49\u5355\u5143\u683c\u6837\u5f0f: \u884c {}, \u5217 {}", context.getRowIndex(), context.getColumnIndex());\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Test\npublic void customCellStyleWrite() {\n    String fileName = "customCellStyleWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, DemoData.class)\n        .registerWriteHandler(new CustomCellStyleWriteHandler())\n        .sheet("\u81ea\u5b9a\u4e49\u6837\u5f0f")\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\u81ea\u5b9a\u4e49-poi-\u6837\u5f0f",children:"\u81ea\u5b9a\u4e49 POI \u6837\u5f0f"}),"\n",(0,i.jsx)(n.h3,{id:"\u6982\u8ff0-3",children:"\u6982\u8ff0"}),"\n",(0,i.jsxs)(n.p,{children:["\u76f4\u63a5\u64cd\u4f5c POI \u7684 ",(0,i.jsx)(n.code,{children:"CellStyle"}),"\uff0c\u9002\u5408\u5bf9\u6837\u5f0f\u7cbe\u786e\u63a7\u5236\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-3",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Test\npublic void poiStyleWrite() {\n    String fileName = "poiStyleWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, DemoData.class)\n        .registerWriteHandler(new CellWriteHandler() {\n            @Override\n            public void afterCellDispose(CellWriteHandlerContext context) {\n                if (BooleanUtils.isNotTrue(context.getHead())) {\n                    Cell cell = context.getCell();\n                    Workbook workbook = context.getWriteWorkbookHolder().getWorkbook();\n\n                    // \u521b\u5efa\u5e76\u8bbe\u7f6e\u6837\u5f0f\n                    CellStyle cellStyle = workbook.createCellStyle();\n                    cellStyle.setFillForegroundColor(IndexedColors.LIGHT_ORANGE.getIndex());\n                    cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);\n                    cell.setCellStyle(cellStyle);\n                }\n            }\n        })\n        .sheet("POI\u6837\u5f0f")\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\u5217\u5bbd\u548c\u884c\u9ad8",children:"\u5217\u5bbd\u548c\u884c\u9ad8"}),"\n",(0,i.jsx)(n.h3,{id:"\u6982\u8ff0-4",children:"\u6982\u8ff0"}),"\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7\u6ce8\u89e3\u63a7\u5236\u5217\u5bbd\u3001\u884c\u9ad8\uff0c\u9002\u7528\u4e8e\u5bf9\u8868\u683c\u683c\u5f0f\u6709\u7279\u5b9a\u8981\u6c42\u7684\u573a\u666f\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"pojo\u7c7b",children:"POJO\u7c7b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Getter\n@Setter\n@EqualsAndHashCode\n@ContentRowHeight(20)\n@HeadRowHeight(30)\n@ColumnWidth(25) // \u9ed8\u8ba4\u5217\u5bbd\npublic class WidthAndHeightData {\n    @ExcelProperty("\u5b57\u7b26\u4e32\u6807\u9898")\n    private String string;\n\n    @ExcelProperty("\u65e5\u671f\u6807\u9898")\n    private Date date;\n\n    @ColumnWidth(50) // \u5355\u72ec\u8bbe\u7f6e\u5217\u5bbd\n    @ExcelProperty("\u6570\u5b57\u6807\u9898")\n    private Double doubleData;\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-4",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Test\npublic void widthAndHeightWrite() {\n    String fileName = "widthAndHeightWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, WidthAndHeightData.class)\n        .sheet()\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u7ed3\u679c-2",children:"\u7ed3\u679c"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(8693).A+"",width:"905",height:"284"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},3659:(e,n,t)=>{t.d(n,{A:()=>l});const l=t.p+"assets/images/annotationStyleWrite-daf422cde61cef375e3a694c3c64a0cb.png"},5966:(e,n,t)=>{t.d(n,{A:()=>l});const l=t.p+"assets/images/handlerStyleWrite-082ae37a51bd9252f6900ab754387401.png"},8693:(e,n,t)=>{t.d(n,{A:()=>l});const l=t.p+"assets/images/widthAndHeightWrite-77c049fb68d1ac806c1ba21e82c45f45.png"}}]);