"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3059],{18:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/writeCellDataWrite-4dacef4c542b683bc9477c595ba19c4c.png"},508:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>s});var i=t(9729);const l={},a=i.createContext(l);function r(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),i.createElement(a.Provider,{value:n},e.children)}},3036:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/commentWrite-d6757c6db4d4ee3ba71d9df3904e489f.png"},4729:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/mergeWrite-976e024ef4e1613c6dab373937cc56ff.png"},6860:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/customHandlerWrite-c05ff79257df5ba72a311793a6e9db60.png"},9121:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"write/extra","title":"\u989d\u5916\u4fe1\u606f","description":"\u672c\u7ae0\u8282\u5c06\u4ecb\u7ecd\u5982\u4f55\u5199\u5165\u989d\u5916\u7684\u4fe1\u606f\uff0c\u5982\u6279\u6ce8\u3001\u8d85\u94fe\u63a5\u3001\u516c\u5f0f\u3001\u5408\u5e76\u5355\u5143\u683c\u7b49\u3002","source":"@site/i18n/zh-cn/docusaurus-plugin-content-docs/current/write/extra.md","sourceDirName":"write","slug":"/write/extra","permalink":"/zh-cn/docs/write/extra","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/fesod/edit/main/website/i18n/zh-cn/docusaurus-plugin-content-docs/current/write/extra.md","tags":[],"version":"current","frontMatter":{"id":"extra","title":"\u989d\u5916\u4fe1\u606f"},"sidebar":"docs","previous":{"title":"\u8868\u5934","permalink":"/zh-cn/docs/write/head"},"next":{"title":"\u683c\u5f0f\u5316","permalink":"/zh-cn/docs/write/format"}}');var l=t(5813),a=t(508);const r={id:"extra",title:"\u989d\u5916\u4fe1\u606f"},s="\u989d\u5916\u4fe1\u606f",d={},c=[{value:"\u6279\u6ce8",id:"\u6279\u6ce8",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c",level:3},{value:"\u8d85\u94fe\u63a5",id:"\u8d85\u94fe\u63a5",level:2},{value:"POJO\u7c7b",id:"pojo\u7c7b",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-1",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c-1",level:3},{value:"\u516c\u5f0f",id:"\u516c\u5f0f",level:2},{value:"POJO\u7c7b",id:"pojo\u7c7b-1",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-2",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c-2",level:3},{value:"\u6839\u636e\u6a21\u677f\u5199\u5165",id:"\u6839\u636e\u6a21\u677f\u5199\u5165",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0-1",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-3",level:3},{value:"\u5408\u5e76\u5355\u5143\u683c",id:"\u5408\u5e76\u5355\u5143\u683c",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0-2",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-4",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c-3",level:3},{value:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668",id:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668",level:2},{value:"\u6982\u8ff0",id:"\u6982\u8ff0-3",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-5",level:3},{value:"\u7ed3\u679c",id:"\u7ed3\u679c-4",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"\u989d\u5916\u4fe1\u606f",children:"\u989d\u5916\u4fe1\u606f"})}),"\n",(0,l.jsx)(n.p,{children:"\u672c\u7ae0\u8282\u5c06\u4ecb\u7ecd\u5982\u4f55\u5199\u5165\u989d\u5916\u7684\u4fe1\u606f\uff0c\u5982\u6279\u6ce8\u3001\u8d85\u94fe\u63a5\u3001\u516c\u5f0f\u3001\u5408\u5e76\u5355\u5143\u683c\u7b49\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u6279\u6ce8",children:"\u6279\u6ce8"}),"\n",(0,l.jsx)(n.h3,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,l.jsx)(n.p,{children:"\u901a\u8fc7\u62e6\u622a\u5668\u5728\u7279\u5b9a\u5355\u5143\u683c\u6dfb\u52a0\u6279\u6ce8\uff0c\u9002\u7528\u4e8e\u6807\u6ce8\u8bf4\u660e\u6216\u7279\u6b8a\u63d0\u793a\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,l.jsx)(n.p,{children:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Slf4j\npublic class CommentWriteHandler implements RowWriteHandler {\n\n    @Override\n    public void afterRowDispose(RowWriteHandlerContext context) {\n        if (BooleanUtils.isTrue(context.getHead())) {\n            Sheet sheet = context.getWriteSheetHolder().getSheet();\n            Drawing<?> drawingPatriarch = sheet.createDrawingPatriarch();\n            // \u5728\u7b2c\u4e00\u884c\u7b2c\u4e8c\u5217\u521b\u5efa\u6279\u6ce8\n            Comment comment = drawingPatriarch.createCellComment(\n                new XSSFClientAnchor(0, 0, 0, 0, (short) 1, 0, (short) 2, 1));\n            comment.setString(new XSSFRichTextString("\u6279\u6ce8\u5185\u5bb9"));\n            sheet.getRow(0).getCell(1).setCellComment(comment);\n        }\n    }\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u4f7f\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Test\npublic void commentWrite() {\n    String fileName = "commentWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, DemoData.class)\n        .inMemory(Boolean.TRUE) // \u6279\u6ce8\u5fc5\u987b\u542f\u7528\u5185\u5b58\u6a21\u5f0f\n        .registerWriteHandler(new CommentWriteHandler())\n        .sheet("\u6279\u6ce8\u793a\u4f8b")\n        .doWrite(data());\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u7ed3\u679c",children:"\u7ed3\u679c"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"img",src:t(3036).A+"",width:"364",height:"295"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u8d85\u94fe\u63a5",children:"\u8d85\u94fe\u63a5"}),"\n",(0,l.jsx)(n.p,{children:"\u5199\u5165\u989d\u5916\u7684\u8d85\u94fe\u63a5\u4fe1\u606f"}),"\n",(0,l.jsx)(n.h3,{id:"pojo\u7c7b",children:"POJO\u7c7b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"@Getter\n@Setter\n@EqualsAndHashCode\npublic class WriteCellDemoData {\n    private WriteCellData<String> hyperlink;\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-1",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Test\npublic void writeHyperlinkDataWrite() {\n    String fileName = "writeCellDataWrite" + System.currentTimeMillis() + ".xlsx";\n    WriteCellDemoData data = new WriteCellDemoData();\n    // \u8bbe\u7f6e\u8d85\u94fe\u63a5\n    data.setHyperlink(new WriteCellData<>("\u70b9\u51fb\u8bbf\u95ee").hyperlink("https://example.com"));\n\n    FastExcel.write(fileName, WriteCellDemoData.class)\n        .sheet()\n        .doWrite(Collections.singletonList(data));\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u7ed3\u679c-1",children:"\u7ed3\u679c"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"img",src:t(18).A+"",width:"576",height:"158"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u516c\u5f0f",children:"\u516c\u5f0f"}),"\n",(0,l.jsx)(n.p,{children:"\u5199\u5165\u989d\u5916\u7684\u516c\u5f0f\u4fe1\u606f"}),"\n",(0,l.jsx)(n.h3,{id:"pojo\u7c7b-1",children:"POJO\u7c7b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"@Getter\n@Setter\n@EqualsAndHashCode\npublic class WriteCellDemoData {\n    private WriteCellData<String> formulaData;\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-2",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Test\npublic void writeFormulaDataWrite() {\n    String fileName = "writeCellDataWrite" + System.currentTimeMillis() + ".xlsx";\n    WriteCellDemoData data = new WriteCellDemoData();\n    // \u8bbe\u7f6e\u516c\u5f0f\n    data.setFormulaData(new WriteCellData<>("=SUM(A1:A10)"));\n\n    FastExcel.write(fileName, WriteCellDemoData.class)\n        .sheet()\n        .doWrite(Collections.singletonList(data));\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u7ed3\u679c-2",children:"\u7ed3\u679c"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"img",src:t(18).A+"",width:"576",height:"158"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u6839\u636e\u6a21\u677f\u5199\u5165",children:"\u6839\u636e\u6a21\u677f\u5199\u5165"}),"\n",(0,l.jsx)(n.h3,{id:"\u6982\u8ff0-1",children:"\u6982\u8ff0"}),"\n",(0,l.jsx)(n.p,{children:"\u652f\u6301\u4f7f\u7528\u5df2\u6709\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u5728\u6a21\u677f\u4e0a\u586b\u5145\u6570\u636e\uff0c\u9002\u7528\u4e8e\u89c4\u8303\u5316\u8f93\u51fa\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-3",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Test\npublic void templateWrite() {\n    String templateFileName = "path/to/template.xlsx";\n    String fileName = "templateWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, DemoData.class)\n        .withTemplate(templateFileName)\n        .sheet()\n        .doWrite(data());\n}\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u5408\u5e76\u5355\u5143\u683c",children:"\u5408\u5e76\u5355\u5143\u683c"}),"\n",(0,l.jsx)(n.h3,{id:"\u6982\u8ff0-2",children:"\u6982\u8ff0"}),"\n",(0,l.jsx)(n.p,{children:"\u652f\u6301\u901a\u8fc7\u6ce8\u89e3\u6216\u81ea\u5b9a\u4e49\u5408\u5e76\u7b56\u7565\u5b9e\u73b0\u5408\u5e76\u5355\u5143\u683c\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-4",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,l.jsx)(n.p,{children:"\u6ce8\u89e3\u65b9\u5f0f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Getter\n@Setter\n@EqualsAndHashCode\npublic class DemoMergeData {\n    @ContentLoopMerge(eachRow = 2) // \u6bcf\u9694 2 \u884c\u5408\u5e76\u4e00\u6b21\n    @ExcelProperty("\u5b57\u7b26\u4e32\u6807\u9898")\n    private String string;\n\n    @ExcelProperty("\u65e5\u671f\u6807\u9898")\n    private Date date;\n\n    @ExcelProperty("\u6570\u5b57\u6807\u9898")\n    private Double doubleData;\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u81ea\u5b9a\u4e49\u5408\u5e76\u7b56\u7565"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"public class CustomMergeStrategy extends AbstractMergeStrategy {\n    @Override\n    protected void merge(Sheet sheet, Cell cell, Head head, Integer relativeRowIndex) {\n        // merge\u65b9\u6cd5\u4f1a\u4e3a\u6bcf\u4e2a\u5355\u5143\u683c\u90fd\u8c03\u7528\u4e00\u6b21\uff0c\u786e\u4fdd\u76f8\u540c\u5355\u5143\u683c\u53ea\u6267\u884c\u4e00\u6b21\u5408\u5e76\n        if (relativeRowIndex != null && relativeRowIndex % 2 == 0 && head.getColumnIndex() == 0) {\n            int startRow = relativeRowIndex + 1; // \u7b2c0\u884c\u662f\u8868\u5934\uff0c\u6570\u636e\u4ece\u7b2c1\u884c\u5f00\u59cb\n            int endRow = startRow + 1; // \u5408\u5e76\u5f53\u524d\u884c\u548c\u4e0b\u4e00\u884c\n            sheet.addMergedRegion(new CellRangeAddress(startRow, endRow, 0, 0));\n        }\n    }\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4f7f\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Test\npublic void mergeWrite() {\n    String fileName = "mergeWrite" + System.currentTimeMillis() + ".xlsx";\n\n    // \u6ce8\u89e3\u65b9\u5f0f\n    FastExcel.write(fileName, DemoMergeData.class)\n        .sheet("\u5408\u5e76\u793a\u4f8b")\n        .doWrite(data());\n\n    // \u81ea\u5b9a\u4e49\u5408\u5e76\u7b56\u7565\n    FastExcel.write(fileName, DemoData.class)\n        .registerWriteHandler(new CustomMergeStrategy())\n        .sheet("\u81ea\u5b9a\u4e49\u5408\u5e76")\n        .doWrite(data());\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u7ed3\u679c-3",children:"\u7ed3\u679c"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"img",src:t(4729).A+"",width:"384",height:"291"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668",children:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668"}),"\n",(0,l.jsx)(n.h3,{id:"\u6982\u8ff0-3",children:"\u6982\u8ff0"}),"\n",(0,l.jsx)(n.p,{children:"\u5b9e\u73b0\u81ea\u5b9a\u4e49\u903b\u8f91\uff08\u5982\u6dfb\u52a0\u4e0b\u62c9\u6846\u7b49\uff09\u9700\u8981\u901a\u8fc7\u62e6\u622a\u5668\u64cd\u4f5c\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-5",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,l.jsx)(n.p,{children:"\u8bbe\u7f6e\u4e0b\u62c9\u6846"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'public class DropdownWriteHandler implements SheetWriteHandler {\n    @Override\n    public void afterSheetCreate(SheetWriteHandlerContext context) {\n        DataValidationHelper helper = context.getWriteSheetHolder().getSheet().getDataValidationHelper();\n        CellRangeAddressList range = new CellRangeAddressList(1, 10, 0, 0); // \u4e0b\u62c9\u6846\u533a\u57df\n        DataValidationConstraint constraint = helper.createExplicitListConstraint(new String[] {"\u9009\u98791", "\u9009\u98792"});\n        DataValidation validation = helper.createValidation(constraint, range);\n        context.getWriteSheetHolder().getSheet().addValidationData(validation);\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u7ed3\u679c-4",children:"\u7ed3\u679c"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"img",src:t(6860).A+"",width:"387",height:"299"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}}}]);