"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3060],{508:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>s});var r=t(9729);const a={},i=r.createContext(a);function c(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),r.createElement(i.Provider,{value:n},e.children)}},2674:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"read/converter","title":"\u683c\u5f0f\u8f6c\u6362","description":"FastExcel \u652f\u6301\u65e5\u671f\u3001\u6570\u5b57\u3001\u81ea\u5b9a\u4e49\u683c\u5f0f\u8f6c\u6362\u3002","source":"@site/i18n/zh-cn/docusaurus-plugin-content-docs/current/read/converter.md","sourceDirName":"read","slug":"/read/converter","permalink":"/zh-cn/docs/read/converter","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/fesod/edit/main/website/i18n/zh-cn/docusaurus-plugin-content-docs/current/read/converter.md","tags":[],"version":"current","frontMatter":{"id":"converter","title":"\u683c\u5f0f\u8f6c\u6362"},"sidebar":"docs","previous":{"title":"\u5b9e\u4f53\u7c7b","permalink":"/zh-cn/docs/read/pojo"},"next":{"title":"\u4e0e Spring \u96c6\u6210","permalink":"/zh-cn/docs/read/spring"}}');var a=t(5813),i=t(508);const c={id:"converter",title:"\u683c\u5f0f\u8f6c\u6362"},s="\u683c\u5f0f\u8f6c\u6362",o={},l=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"POJO \u7c7b",id:"pojo-\u7c7b",level:3},{value:"\u8f6c\u6362\u5668",id:"\u8f6c\u6362\u5668",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"\u683c\u5f0f\u8f6c\u6362",children:"\u683c\u5f0f\u8f6c\u6362"})}),"\n",(0,a.jsx)(n.p,{children:"FastExcel \u652f\u6301\u65e5\u671f\u3001\u6570\u5b57\u3001\u81ea\u5b9a\u4e49\u683c\u5f0f\u8f6c\u6362\u3002"}),"\n",(0,a.jsx)(n.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u5bf9\u8bfb\u53d6\u6216\u5199\u5165\u7684\u6570\u636e\u8fdb\u884c\u7279\u5b9a\u683c\u5f0f\u7684\u8f6c\u6362\u3002FastExcel \u63d0\u4f9b\u4e86\u7075\u6d3b\u7684\u8f6c\u6362\u5668\u673a\u5236\uff0c\u5141\u8bb8\u7528\u6237\u81ea\u5b9a\u4e49\u6570\u636e\u8f6c\u6362\u89c4\u5219\uff0c\u4ee5\u6ee1\u8db3\u5404\u79cd\u4e1a\u52a1\u9700\u6c42\u3002"}),"\n",(0,a.jsx)(n.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,a.jsx)(n.h3,{id:"pojo-\u7c7b",children:"POJO \u7c7b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'@Getter\n@Setter\n@EqualsAndHashCode\npublic class ConverterData {\n    @ExcelProperty(converter = CustomStringStringConverter.class)\n    private String string;\n\n    @DateTimeFormat("yyyy\u5e74MM\u6708dd\u65e5HH\u65f6mm\u5206ss\u79d2")\n    private String date;\n\n    @NumberFormat("#.##%")\n    private String doubleData;\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u8f6c\u6362\u5668",children:"\u8f6c\u6362\u5668"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'public class CustomStringStringConverter implements Converter<String> {\n    @Override\n    public Class<?> supportJavaTypeKey() {\n        return String.class;\n    }\n\n    @Override\n    public CellDataTypeEnum supportExcelTypeKey() {\n        return CellDataTypeEnum.STRING;\n    }\n\n    @Override\n    public String convertToJavaData(ReadConverterContext<?> context) {\n        return "\u81ea\u5b9a\u4e49\uff1a" + context.getReadCellData().getStringValue();\n    }\n\n    @Override\n    public WriteCellData<?> convertToExcelData(WriteConverterContext<String> context) {\n        return new WriteCellData<>(context.getValue());\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'@Test\npublic void converterRead() {\n    String fileName = "path/to/demo.xlsx";\n\n    FastExcel.read(fileName, ConverterData.class, new DemoDataListener())\n            .registerConverter(new CustomStringStringConverter()) // \u6ce8\u518c\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668\n            .sheet()\n            .doRead();\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);