"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4587],{508:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>s});var l=n(9729);const i={},r=l.createContext(i);function o(e){const t=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),l.createElement(r.Provider,{value:t},e.children)}},3659:(e,t,n)=>{n.d(t,{A:()=>l});const l=n.p+"assets/images/annotationStyleWrite-daf422cde61cef375e3a694c3c64a0cb.png"},5966:(e,t,n)=>{n.d(t,{A:()=>l});const l=n.p+"assets/images/handlerStyleWrite-082ae37a51bd9252f6900ab754387401.png"},8693:(e,t,n)=>{n.d(t,{A:()=>l});const l=n.p+"assets/images/widthAndHeightWrite-77c049fb68d1ac806c1ba21e82c45f45.png"},9296:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"write/style","title":"Style","description":"This chapter introduces style settings when writing data.","source":"@site/docs/write/style.md","sourceDirName":"write","slug":"/write/style","permalink":"/docs/write/style","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/fesod/edit/main/website/docs/write/style.md","tags":[],"version":"current","frontMatter":{"id":"style","title":"Style"},"sidebar":"docs","previous":{"title":"POJO","permalink":"/docs/write/pojo"},"next":{"title":"Spring","permalink":"/docs/write/spring"}}');var i=n(5813),r=n(508);const o={id:"style",title:"Style"},s="Style",a={},d=[{value:"Annotations",id:"annotations",level:2},{value:"Overview",id:"overview",level:3},{value:"POJO Class",id:"pojo-class",level:3},{value:"Code Example",id:"code-example",level:3},{value:"Result",id:"result",level:3},{value:"Built-in Interceptors",id:"built-in-interceptors",level:2},{value:"Overview",id:"overview-1",level:3},{value:"Code Example",id:"code-example-1",level:3},{value:"Result",id:"result-1",level:3},{value:"Custom Interceptors",id:"custom-interceptors",level:2},{value:"Overview",id:"overview-2",level:3},{value:"Code Example",id:"code-example-2",level:3},{value:"Custom POI Styles",id:"custom-poi-styles",level:2},{value:"Overview",id:"overview-3",level:3},{value:"Code Example",id:"code-example-3",level:3},{value:"Column Width and Row Height",id:"column-width-and-row-height",level:2},{value:"Overview",id:"overview-4",level:3},{value:"POJO Class",id:"pojo-class-1",level:3},{value:"Code Example",id:"code-example-4",level:3},{value:"Result",id:"result-2",level:3}];function c(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"style",children:"Style"})}),"\n",(0,i.jsx)(t.p,{children:"This chapter introduces style settings when writing data."}),"\n",(0,i.jsx)(t.h2,{id:"annotations",children:"Annotations"}),"\n",(0,i.jsx)(t.h3,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(t.p,{children:"Set cell styles through annotations in entity classes, including font, background color, row height, etc."}),"\n",(0,i.jsx)(t.h3,{id:"pojo-class",children:"POJO Class"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:'@Getter\n@Setter\n@EqualsAndHashCode\n// Set header background to red\n@HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 10)\n// Set header font size to 20\n@HeadFontStyle(fontHeightInPoints = 20)\n// Set content background to green\n@ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 17)\n// Set content font size to 20\n@ContentFontStyle(fontHeightInPoints = 20)\npublic class DemoStyleData {\n    // Individually set header and content styles for a specific column\n    @HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 14)\n    @HeadFontStyle(fontHeightInPoints = 30)\n    @ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 40)\n    @ContentFontStyle(fontHeightInPoints = 30)\n    @ExcelProperty("\u5b57\u7b26\u4e32\u6807\u9898")\n    private String string;\n\n    @ExcelProperty("\u65e5\u671f\u6807\u9898")\n    private Date date;\n\n    @ExcelProperty("\u6570\u5b57\u6807\u9898")\n    private Double doubleData;\n}\n'})}),"\n",(0,i.jsx)(t.h3,{id:"code-example",children:"Code Example"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:'@Test\npublic void annotationStyleWrite() {\n    String fileName = "annotationStyleWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, DemoStyleData.class)\n        .sheet()\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(t.h3,{id:"result",children:"Result"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"img",src:n(3659).A+"",width:"529",height:"427"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"built-in-interceptors",children:"Built-in Interceptors"}),"\n",(0,i.jsx)(t.h3,{id:"overview-1",children:"Overview"}),"\n",(0,i.jsxs)(t.p,{children:["Use ",(0,i.jsx)(t.code,{children:"HorizontalCellStyleStrategy"})," to set styles for headers and content separately."]}),"\n",(0,i.jsx)(t.h3,{id:"code-example-1",children:"Code Example"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:'@Test\npublic void handlerStyleWrite() {\n    String fileName = "handlerStyleWrite" + System.currentTimeMillis() + ".xlsx";\n\n    // Define header style\n    WriteCellStyle headStyle = new WriteCellStyle();\n    headStyle.setFillForegroundColor(IndexedColors.RED.getIndex()); // Red background\n    WriteFont headFont = new WriteFont();\n    headFont.setFontHeightInPoints((short) 20); // Font size 20\n    headStyle.setWriteFont(headFont);\n\n    // Define content style\n    WriteCellStyle contentStyle = new WriteCellStyle();\n    contentStyle.setFillForegroundColor(IndexedColors.GREEN.getIndex()); // Green background\n    contentStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);\n    WriteFont contentFont = new WriteFont();\n    contentFont.setFontHeightInPoints((short) 20);\n    contentStyle.setWriteFont(contentFont);\n\n    // Use strategy to set styles\n    HorizontalCellStyleStrategy styleStrategy =\n        new HorizontalCellStyleStrategy(headStyle, contentStyle);\n\n    FastExcel.write(fileName, DemoData.class)\n        .registerWriteHandler(styleStrategy)\n        .sheet("\u6837\u5f0f\u6a21\u677f")\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(t.h3,{id:"result-1",children:"Result"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"img",src:n(5966).A+"",width:"345",height:"288"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"custom-interceptors",children:"Custom Interceptors"}),"\n",(0,i.jsx)(t.h3,{id:"overview-2",children:"Overview"}),"\n",(0,i.jsxs)(t.p,{children:["If existing strategies cannot meet requirements, you can implement the ",(0,i.jsx)(t.code,{children:"CellWriteHandler"})," interface for complete custom control over styling."]}),"\n",(0,i.jsx)(t.h3,{id:"code-example-2",children:"Code Example"}),"\n",(0,i.jsx)(t.p,{children:"Custom interceptor"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:'@Slf4j\npublic class CustomCellStyleWriteHandler implements CellWriteHandler {\n\n    @Override\n    public void afterCellDispose(CellWriteHandlerContext context) {\n        // Only set styles for content cells\n        if (BooleanUtils.isNotTrue(context.getHead())) {\n            WriteCellData<?> cellData = context.getFirstCellData();\n            WriteCellStyle writeCellStyle = cellData.getOrCreateStyle();\n\n            // Set background color to yellow\n            writeCellStyle.setFillForegroundColor(IndexedColors.YELLOW.getIndex());\n            writeCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);\n\n            // Set font to blue\n            WriteFont writeFont = new WriteFont();\n            writeFont.setColor(IndexedColors.BLUE.getIndex());\n            writeFont.setFontHeightInPoints((short) 14); // Font size 14\n            writeCellStyle.setWriteFont(writeFont);\n\n            log.info("\u5df2\u81ea\u5b9a\u4e49\u5355\u5143\u683c\u6837\u5f0f: \u884c {}, \u5217 {}", context.getRowIndex(), context.getColumnIndex());\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(t.p,{children:"Usage"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:'@Test\npublic void customCellStyleWrite() {\n    String fileName = "customCellStyleWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, DemoData.class)\n        .registerWriteHandler(new CustomCellStyleWriteHandler())\n        .sheet("\u81ea\u5b9a\u4e49\u6837\u5f0f")\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"custom-poi-styles",children:"Custom POI Styles"}),"\n",(0,i.jsx)(t.h3,{id:"overview-3",children:"Overview"}),"\n",(0,i.jsxs)(t.p,{children:["Directly manipulate POI's ",(0,i.jsx)(t.code,{children:"CellStyle"}),", suitable for precise style control."]}),"\n",(0,i.jsx)(t.h3,{id:"code-example-3",children:"Code Example"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:'@Test\npublic void poiStyleWrite() {\n    String fileName = "poiStyleWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, DemoData.class)\n        .registerWriteHandler(new CellWriteHandler() {\n            @Override\n            public void afterCellDispose(CellWriteHandlerContext context) {\n                if (BooleanUtils.isNotTrue(context.getHead())) {\n                    Cell cell = context.getCell();\n                    Workbook workbook = context.getWriteWorkbookHolder().getWorkbook();\n\n                    // Create and set style\n                    CellStyle cellStyle = workbook.createCellStyle();\n                    cellStyle.setFillForegroundColor(IndexedColors.LIGHT_ORANGE.getIndex());\n                    cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);\n                    cell.setCellStyle(cellStyle);\n                }\n            }\n        })\n        .sheet("POI\u6837\u5f0f")\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"column-width-and-row-height",children:"Column Width and Row Height"}),"\n",(0,i.jsx)(t.h3,{id:"overview-4",children:"Overview"}),"\n",(0,i.jsx)(t.p,{children:"Control column width and row height through annotations, suitable for scenarios with specific table format requirements."}),"\n",(0,i.jsx)(t.h3,{id:"pojo-class-1",children:"POJO Class"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:'@Getter\n@Setter\n@EqualsAndHashCode\n@ContentRowHeight(20)\n@HeadRowHeight(30)\n@ColumnWidth(25) // Default column width\npublic class WidthAndHeightData {\n    @ExcelProperty("\u5b57\u7b26\u4e32\u6807\u9898")\n    private String string;\n\n    @ExcelProperty("\u65e5\u671f\u6807\u9898")\n    private Date date;\n\n    @ColumnWidth(50) // Individually set column width\n    @ExcelProperty("\u6570\u5b57\u6807\u9898")\n    private Double doubleData;\n}\n'})}),"\n",(0,i.jsx)(t.h3,{id:"code-example-4",children:"Code Example"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:'@Test\npublic void widthAndHeightWrite() {\n    String fileName = "widthAndHeightWrite" + System.currentTimeMillis() + ".xlsx";\n\n    FastExcel.write(fileName, WidthAndHeightData.class)\n        .sheet()\n        .doWrite(data());\n}\n'})}),"\n",(0,i.jsx)(t.h3,{id:"result-2",children:"Result"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"img",src:n(8693).A+"",width:"905",height:"284"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);